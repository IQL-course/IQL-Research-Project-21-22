df <- df %>% rename(`E[eta]`=eta) %>% mutate(`Lmin/E[L]` = Lmin/L,length_def = length_def) %>%
select(language,`Lmin/E[L]`,`E[eta]`,length_def)
})
df <- do.call(rbind,rows_cv)
reshape2::melt(df, id.vars=c('language','Lmin/Lrand','length_def')) %>%
ggplot(aes(x=`Lmin/E[L]`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
rows_cv <- lapply(length_defs[1], function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% rename(`E[eta]`=eta) %>% mutate(`Lmin/E[L]` = Lmin/L,length_def = length_def) %>%
select(language,`Lmin/E[L]`,`E[eta]`,length_def)
})
df <- do.call(rbind,rows_cv)
reshape2::melt(df, id.vars=c('language','Lmin/E[L]','length_def')) %>%
ggplot(aes(x=`Lmin/E[L]`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
rows_cv <- lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% rename(`E[eta]`=eta) %>% mutate(`Lmin/E[L]` = Lmin/L,length_def = length_def) %>%
select(language,`Lmin/E[L]`,`E[eta]`,length_def)
})
df <- do.call(rbind,rows_cv)
reshape2::melt(df, id.vars=c('language','Lmin/E[L]','length_def')) %>%
ggplot(aes(x=`Lmin/E[L]`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
reshape2::melt(df, id.vars=c('language','Lmin/E[L]','length_def')) %>%
ggplot(aes(x=`Lmin/E[L]`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
df
ggplot(df, aes(x=`Lmin/E[L]`,y=`E[eta]`,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
ggplot(df, aes(x=`Lmin/E[L]`,y=`E[eta]`,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_wrap(~length_def,scales = 'free')
ggplot(df, aes(x=`Lmin/E[L]`,y=`E[eta]`,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_wrap(~length_def)
ggsave(here('figures',paste0('correlation_E[eta]_LminE[L].pdf')))
# E[eta] vs Lmin/E[L]
rows <- lapply(COLLS, function(collection) {
if (collection == 'cv') {
rows_cv <- lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% rename(`E[eta]`=eta) %>%
mutate(`Lmin/E[L]` = Lmin/L,collection = paste0(collection,'-',length_def)) %>%
select(language,`Lmin/E[L]`,`E[eta]`,collection)
})
df <- do.call(rbind,rows_cv)
} else {
length_def <- 'characters'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% rename(`E[eta]`=eta) %>%
mutate(`Lmin/E[L]` = Lmin/L,collection = paste0(collection,'-',length_def)) %>%
select(language,`Lmin/E[L]`,`E[eta]`,collection)
}
})
df <- do.call(rbind,rows)
df
ggplot(df, aes(x=`Lmin/E[L]`,y=`E[eta]`,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_wrap(~collection)
# E[eta] vs Lmin/E[L]
rows <- lapply(COLLS, function(collection) {
if (collection == 'pud') {
length_def <- 'characters'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% rename(`E[eta]`=eta) %>%
mutate(`Lmin/E[L]` = Lmin/L,collection = paste0(collection,'-',length_def)) %>%
select(language,`Lmin/E[L]`,`E[eta]`,collection)
} else {
rows_cv <- lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% rename(`E[eta]`=eta) %>%
mutate(`Lmin/E[L]` = Lmin/L,collection = paste0(collection,'-',length_def)) %>%
select(language,`Lmin/E[L]`,`E[eta]`,collection)
})
df <- do.call(rbind,rows_cv)
}
})
df <- do.call(rbind,rows)
ggplot(df, aes(x=`Lmin/E[L]`,y=`E[eta]`,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_wrap(~collection)
ggplot(df, aes(x=`Lmin/E[L]`,y=`E[eta]`,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_wrap(~factor(collection, levels = c('pud-characters','cv-medianDuration','cv-characters')))
ggsave(here('figures',paste0('correlation_E[eta]_LminE[L].pdf')))
corr_type
score
score <- 'psi'
plot_timeVSspace(score, corr_type)
plot_timeVSspace <- function(score,corr_type) {
df_chars <- read.csv(here('results',paste0('optimality_scores_cv_characters',corr_suffix,'.csv')))[-1]
df_chars$space <- if (score == 'omega') df_chars$omega else if (score == 'psi') df_chars$psi
rows_cv <- lapply(c('medianDuration','meanDuration'), function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('optimality_scores_cv',suffix,corr_suffix,'.csv')))[-1 ]%>% dplyr::select(-Lmin,-L,-Lrand,-eta)
df$score <- if (score == 'omega') df$omega else if (score == 'psi') df$psi
df %>% rename(time = score) %>% mutate(time_def = length_def)
})
merged_dfs <- lapply(rows_cv, function(df_time) merge(df_time,df_chars, by = c('language')))
df <- do.call(rbind.data.frame,merged_dfs) %>%
mutate(label = ifelse(abs(time-space)>=0.10,language,''),color = ifelse(abs(time-space)<0.10,'deviation<10%','deviation>=10%'))
df %>%
ggplot(aes(space,time,label = label,color=color)) + geom_point() + theme(legend.position = 'bottom') +
facet_wrap(~factor(time_def, levels=c('medianDuration','meanDuration'))) +
geom_abline(intercept = 0, slope=1, color = 'purple') + geom_text_repel() + #nudge_x = 0.04,nudge_y = 0.02,size = 3
labs(x=paste0(score,' (characters)'), y = paste0(score,' (duration)')) +
scale_color_manual(values = c("blue","red"),limits = c('deviation>=10%', 'deviation<10%'))
}
plot_timeVSspace(score, corr_type)
plot_timeVSspace <- function(score,corr_type) {
df_chars <- read.csv(here('results',paste0('optimality_scores_cv_characters',corr_suffix,'.csv')))[-1]
df_chars$space <- if (score == 'omega') df_chars$omega else if (score == 'psi') df_chars$psi
rows_cv <- lapply(c('medianDuration','meanDuration'), function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('optimality_scores_cv',suffix,corr_suffix,'.csv')))[-1 ]%>% dplyr::select(-Lmin,-L,-Lrand,-eta)
df$score <- if (score == 'omega') df$omega else if (score == 'psi') df$psi
df %>% rename(time = score) %>% mutate(time_def = length_def)
})
merged_dfs <- lapply(rows_cv, function(df_time) merge(df_time,df_chars, by = c('language')))
df <- do.call(rbind.data.frame,merged_dfs) %>%
mutate(label = ifelse(abs(time-space)>=0.10,language,''),color = ifelse(abs(time-space)<0.10,'deviation<10%','deviation>=10%'))
df %>%
ggplot(aes(space,time,label = label,color=color)) + geom_point() + theme(legend.position = 'bottom') +
facet_wrap(~factor(time_def, levels=c('medianDuration','meanDuration'))) +
geom_abline(intercept = 0, slope=1, color = 'purple') + geom_text_repel(size = 2) +
labs(x=paste0(score,' (characters)'), y = paste0(score,' (duration)')) +
scale_color_manual(values = c("blue","red"),limits = c('deviation>=10%', 'deviation<10%'))
}
plot_timeVSspace(score, corr_type)
plot_timeVSspace <- function(score,corr_type) {
df_chars <- read.csv(here('results',paste0('optimality_scores_cv_characters',corr_suffix,'.csv')))[-1]
df_chars$space <- if (score == 'omega') df_chars$omega else if (score == 'psi') df_chars$psi
rows_cv <- lapply(c('medianDuration','meanDuration'), function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('optimality_scores_cv',suffix,corr_suffix,'.csv')))[-1 ]%>% dplyr::select(-Lmin,-L,-Lrand,-eta)
df$score <- if (score == 'omega') df$omega else if (score == 'psi') df$psi
df %>% rename(time = score) %>% mutate(time_def = length_def)
})
merged_dfs <- lapply(rows_cv, function(df_time) merge(df_time,df_chars, by = c('language')))
df <- do.call(rbind.data.frame,merged_dfs) %>%
mutate(label = ifelse(abs(time-space)>=0.10,language,''),color = ifelse(abs(time-space)<0.10,'deviation<10%','deviation>=10%'))
df %>%
ggplot(aes(space,time,label = label,color=color)) + geom_point() + theme(legend.position = 'bottom') +
facet_wrap(~factor(time_def, levels=c('medianDuration','meanDuration'))) +
geom_abline(intercept = 0, slope=1, color = 'purple') + geom_text_repel(size = 3) +
labs(x=paste0(score,' (characters)'), y = paste0(score,' (duration)')) +
scale_color_manual(values = c("blue","red"),limits = c('deviation>=10%', 'deviation<10%'))
}
plot_timeVSspace(score, corr_type)
# + Omega in time vs Omega in chars
lapply(c('omega','psi'), function(score) {
plot_timeVSspace(score, corr_type)
ggsave(here('figures',paste0(score,'_timeVSspace',corr_suffix,'.pdf')))
})
# + density plots
rows <- lapply(COLLS, function(collection) {
if (collection =='cv') {
rows <- lapply(length_defs, function(length) {
suffix <- paste0("_",length)
read.csv(here('results',paste0('optimality_scores_',collection,suffix,corr_suffix,'.csv')))[-1] %>%
select(language,eta,psi,omega) %>% mutate(collection = collection, `length definition` = length)
})
do.call(rbind.data.frame,rows)
} else if (collection =='pud') {
length <- 'characters'
suffix <- paste0("_",length)
read.csv(here('results',paste0('optimality_scores_',collection,suffix,corr_suffix,'.csv')))[-1] %>%
select(language,eta,psi,omega) %>% mutate(collection = collection, `length definition` = length) %>%
filter(language %!in% c('Chinese-strokes','Japanese-strokes'))
}
})
df <- do.call(rbind.data.frame,rows) %>%
melt(id.vars = c('language','collection','length definition'))
means <- df %>% group_by(collection,`length definition`,variable) %>% summarise(meanvalue = mean(value))
ggplot(df) + geom_density(aes(x=value,color = `length definition`, fill = `length definition`),alpha = 0.2) + facet_grid(rows = vars(collection), cols = vars(variable)) +
geom_vline(data=means, aes(xintercept=meanvalue, color = `length definition`),linetype='dashed') +
theme(legend.position = 'bottom') + theme(axis.text.x = element_text(angle = 60, vjust = 0, hjust=0))
ggplot(df) + geom_density(aes(x=value,color = `length definition`, fill = `length definition`),alpha = 0.2) + facet_grid(rows = vars(collection), cols = vars(variable)) +
geom_vline(data=means, aes(xintercept=meanvalue, color = `length definition`),linetype='dashed') +
theme(legend.position = 'bottom') + theme(axis.text.x = element_text(angle = 60, vjust = 0, hjust=0))
ggsave(here('figures',paste0('opt_scores_density',corr_suffix,'.pdf')))
# NULL HYPOTHESYS --------------------------------------------------------------
iters <- 1e05
plot_corr
plot_corr_suffix <- paste0('_',plot_corr)
out_suffix <- ifelse(remove_out==T,'_noOut','')
length_def
length_def <- 'medianDuration'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1] %>%
mutate(new_psi = (Lrand-L)/(Lrand-Lmin))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
plot_corr <- 'kendall'
plot_corr <- 'pearson'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1] %>%
mutate(new_psi = (Lrand-L)/(Lrand-Lmin))
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
# + summary opt scores null
lapply(c('omega','eta','psi'), function(score) {
summ <- opt_score_summary(score,corr_type,null=T,iters = iters) %>% mutate(empty = rep('',3))
summ <- summ[,c(8,1,2,3,4,5,6,7)]
print(xtable(summ, type = "latex",digits=3),
file = here('latex_tables',paste0("opt_scores_summary_null_",score,corr_suffix,".tex")),
caption.placement = "top",include.rownames=FALSE,include.colnames=FALSE,only.contents = TRUE)
})
## correlation wit Lmin, Lr, and Lmin/Lr
remove_out <- F
lapply(c('kendall','pearson'), function(plot_corr) {
plot_corr_suffix <- paste0('_',plot_corr)
out_suffix <- ifelse(remove_out==T,'_noOut','')
rows <- lapply(COLLS, function(collection) {
if (collection == 'cv') {
lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1] %>%
mutate(new_psi = (Lrand-L)/(Lrand-Lmin))
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
})
} else {
length_def <- 'characters'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1] %>%
mutate(omega = (Lrand-L)/(Lrand-Lmin))
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
}
})
})
# E[scores] vs Lmin/Lr
collection <- 'cv'
rows_cv <- lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% mutate(`Lmin/Lrand` = Lmin/Lrand) %>% dplyr::select(language,`Lmin/Lrand`,psi,omega) %>%
rename(`E[psi]`=psi, `E[omega]`=omega) %>% mutate(length_def = length_def)
})
df <- do.call(rbind,rows_cv)
reshape2::melt(df, id.vars=c('language','Lmin/Lrand','length_def')) %>%
ggplot(aes(x=`Lmin/Lrand`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
rows_cv <- lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% mutate(`Lmin/Lrand` = Lmin/Lrand) %>% dplyr::select(language,Lmin,psi,omega) %>%
rename(`E[psi]`=psi, `E[omega]`=omega) %>% mutate(length_def = length_def)
})
df <- do.call(rbind,rows_cv)
reshape2::melt(df, id.vars=c('language','Lmin','length_def')) %>%
ggplot(aes(x=`Lmin`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
ggsave(here('figures',paste0('correlation_scores_Lmin.pdf')))
# E[eta] vs Lmin/E[L]
rows <- lapply(COLLS, function(collection) {
if (collection == 'pud') {
length_def <- 'characters'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% rename(`E[eta]`=eta) %>%
mutate(`Lmin/E[L]` = Lmin/L,collection = paste0(collection,'-',length_def)) %>%
select(language,`Lmin/E[L]`,`E[eta]`,collection)
} else {
rows_cv <- lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% rename(`E[eta]`=eta) %>%
mutate(`Lmin/E[L]` = Lmin/L,collection = paste0(collection,'-',length_def)) %>%
select(language,`Lmin/E[L]`,`E[eta]`,collection)
})
df <- do.call(rbind,rows_cv)
}
})
df <- do.call(rbind,rows)
ggplot(df, aes(x=`Lmin/E[L]`,y=`E[eta]`,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + #geom_text(nudge_x = -0.1, nudge_y = -0.00005) +
facet_wrap(~factor(collection, levels = c('pud-characters','cv-medianDuration','cv-characters')))
ggsave(here('figures',paste0('correlation_E[eta]_LminE[L].pdf')))
rows_cv <- lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
df <- df %>% mutate(`Lmin/Lrand` = Lmin/Lrand) %>% dplyr::select(language,Lmin,psi,omega) %>%
rename(`E[psi]`=psi, `E[omega]`=omega) %>% mutate(length_def = length_def)
})
df <- do.call(rbind,rows_cv)
reshape2::melt(df, id.vars=c('language','Lmin','length_def')) %>%
ggplot(aes(x=`Lmin`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + geom_hline(yintercept = 0,color='purple') +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
ggsave(here('figures',paste0('correlation_scores_Lmin.pdf')))
reshape2::melt(df, id.vars=c('language','Lmin','length_def')) %>%
ggplot(aes(x=`Lmin`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+ geom_text()
reshape2::melt(df, id.vars=c('language','Lmin','length_def')) %>%
ggplot(aes(x=`Lmin`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+ geom_text() +
geom_point() + geom_hline(yintercept = 0,color='purple') +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
reshape2::melt(df, id.vars=c('language','Lmin','length_def')) %>%
ggplot(aes(x=`Lmin`,y=value,label=language)) +
geom_abline(slope=1,intercept=0,color='purple')+
geom_point() + geom_hline(yintercept = 0,color='purple') +
facet_grid(cols=vars(length_def),rows=vars(variable),scales = 'free')
# + ranking correlation
sapply(c('psi','omega'), function(scoree) {
score_df <- df_common %>% filter(score == scoree) %>% arrange(pud) %>% select(pud,cv)
cor  <- cor(score_df,method='kendall')[2,1]
pval <- cor_pmat(score_df,method='kendall')[2,1]
list('cor'=cor,'pval'=pval)
})
# PUD and CV languages  --------------------------------------------------------
common_langs <- langs_df_cv[langs_df_cv$language %in% langs_df_pud$language,]$language
dfs <- lapply(COLLS, function(collection) {
suffix <- '_characters'
dfs <- lapply(c('psi','omega'), function(score) {
df <- read.csv(here('results',paste0('optimality_scores_',collection,suffix,corr_suffix,'.csv')))[-1] %>%
filter(language %in% common_langs)
df <- if (score == 'psi') select(df,language,psi) %>% mutate(score = 'psi') else select(df,language,omega) %>% mutate(score = 'omega')
if (score == 'psi') rename(df,value=psi)  else rename(df,value=omega)
})
df <- do.call(rbind.data.frame,dfs)
if (collection == 'cv') rename(df, cv=value ) else rename(df, pud=value )
})
df_common <- merge(dfs[[1]],dfs[[2]],by=c('language','score'))
ggplot(df_common,aes(pud,cv,label=language)) + geom_abline(intercept = 0,slope=1,color='purple')+
geom_point() + geom_text(size=2,nudge_y = 0.01) + facet_wrap(~score,scales='free')
ggsave(here('figures',paste0('cvVSpud.pdf')))
# + ranking correlation
sapply(c('psi','omega'), function(scoree) {
score_df <- df_common %>% filter(score == scoree) %>% arrange(pud) %>% select(pud,cv)
cor  <- cor(score_df,method='kendall')[2,1]
pval <- cor_pmat(score_df,method='kendall')[2,1]
list('cor'=cor,'pval'=pval)
})
df_common <- merge(dfs[[1]],dfs[[2]],by=c('language','score'))
ggplot(df_common,aes(pud,cv,label=language)) + geom_abline(intercept = 0,slope=1,color='purple')+
geom_point() + geom_text(size=2,nudge_y = 0.01) + facet_wrap(~score,scales='free')
ggsave(here('figures',paste0('cvVSpud.pdf')))
# + ranking correlation
sapply(c('psi','omega'), function(scoree) {
score_df <- df_common %>% filter(score == scoree) %>% arrange(pud) %>% select(pud,cv)
cor  <- cor(score_df,method='kendall')[2,1]
pval <- cor_pmat(score_df,method='kendall')[2,1]
list('cor'=cor,'pval'=pval)
})
source('R_functions.R')
plot_correlogram <- function(df,plot_corr,title,type,HB_correct,lab_size,tl.cex,pch.cex) {
df <- df %>% rename(Lr = Lrand)
subtitle_pref <- switch(type, 'scores'='Relations among scores',
'params'='Relations with parameters', 'null'='Under null hypothesis')
if (type == 'null')   df <- df %>% mutate(`Lmin/Lr`=Lmin/Lrand) %>% dplyr::select(Lmin,Lr,`Lmin/Lr`,eta,psi,omega) %>%
rename(`E[eta]`=eta, `E[psi]`=psi, `E[omega]`=omega)
cors  <- round(cor(df, method=plot_corr), 2)
p.mat <- cor_pmat(df, method=plot_corr)
if (HB_correct) p.mat <- HB_correction(p.mat)
ggcorrplot(cors, type = "lower", p.mat = p.mat,lab=T, lab_size = lab_size, tl.cex = tl.cex, pch.cex = pch.cex,
colors = switch(plot_corr, 'kendall'=corr_colors_tau, 'pearson'=corr_colors_r)) +
labs(title=title, subtitle=paste0(subtitle_pref, ifelse(HB_correct,' (HB)',''))) +
theme(plot.title = element_text(size=22),plot.subtitle = element_text(size=16))
}
## correlation wit Lmin, Lr, and Lmin/Lr
remove_out <- F
lapply(c('kendall','pearson'), function(plot_corr) {
plot_corr_suffix <- paste0('_',plot_corr)
out_suffix <- ifelse(remove_out==T,'_noOut','')
rows <- lapply(COLLS, function(collection) {
if (collection == 'cv') {
lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
})
} else {
length_def <- 'characters'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
}
})
})
# NULL HYPOTHESYS --------------------------------------------------------------
iters <- 1e05
## correlation wit Lmin, Lr, and Lmin/Lr
remove_out <- F
lapply(c('kendall','pearson'), function(plot_corr) {
plot_corr_suffix <- paste0('_',plot_corr)
out_suffix <- ifelse(remove_out==T,'_noOut','')
rows <- lapply(COLLS, function(collection) {
if (collection == 'cv') {
lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
})
} else {
length_def <- 'characters'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
}
})
})
plot_correlogram <- function(df,plot_corr,title,type,HB_correct,lab_size,tl.cex,pch.cex) {
df <- df %>% rename(Lr = Lrand)
subtitle_pref <- switch(type, 'scores'='Relations among scores',
'params'='Relations with parameters', 'null'='Under null hypothesis')
if (type == 'null')   df <- df %>% mutate(`Lmin/Lr`=Lmin/Lr) %>% dplyr::select(Lmin,Lr,`Lmin/Lr`,eta,psi,omega) %>%
rename(`E[eta]`=eta, `E[psi]`=psi, `E[omega]`=omega)
cors  <- round(cor(df, method=plot_corr), 2)
p.mat <- cor_pmat(df, method=plot_corr)
if (HB_correct) p.mat <- HB_correction(p.mat)
ggcorrplot(cors, type = "lower", p.mat = p.mat,lab=T, lab_size = lab_size, tl.cex = tl.cex, pch.cex = pch.cex,
colors = switch(plot_corr, 'kendall'=corr_colors_tau, 'pearson'=corr_colors_r)) +
labs(title=title, subtitle=paste0(subtitle_pref, ifelse(HB_correct,' (HB)',''))) +
theme(plot.title = element_text(size=22),plot.subtitle = element_text(size=16))
}
lapply(c('kendall','pearson'), function(plot_corr) {
plot_corr_suffix <- paste0('_',plot_corr)
out_suffix <- ifelse(remove_out==T,'_noOut','')
rows <- lapply(COLLS, function(collection) {
if (collection == 'cv') {
lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
})
} else {
length_def <- 'characters'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
}
})
})
lapply(c('kendall','pearson'), function(plot_corr) {
plot_corr_suffix <- paste0('_',plot_corr)
out_suffix <- ifelse(remove_out==T,'_noOut','')
rows <- lapply(COLLS, function(collection) {
if (collection == 'cv') {
lapply(length_defs, function(length_def) {
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
})
} else {
length_def <- 'characters'
suffix       <- paste0("_",length_def)
df <- read.csv(here('results',paste0('null_hypothesis_',collection,suffix,'_',iters,corr_suffix,'.csv')))[-1]
if (remove_out == T) df <-  df %>% filter(language %!in% c('Abkhazian','Panjabi'))
title <- paste(collection,length_def,sep='-')
plot_correlogram(df,plot_corr,title,'null',HB_correct=T,6,15,18)
ggsave(here('figures',paste0('corrplot_null_',collection,suffix,plot_corr_suffix,out_suffix,'.pdf')))
}
})
})
